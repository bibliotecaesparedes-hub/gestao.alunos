<!DOCTYPE html>
<html lang='pt-PT'>
<head>
  <meta charset='utf-8'/>
  <meta name='viewport' content='width=device-width, initial-scale=1'/>
  <title>ESP.EE · Painel Professor v7</title>
  <link rel='stylesheet' href='style.css'/>
</head>
<body>
  <div class='topbar'>
    <div class='brand'>ESP.EE · Painel Professor</div>
    <div class='top-actions'>
      <span id='syncIndicator' class='muted'>—</span>
      <span id='profBanner' class='session-pill'>Sessão: não iniciada</span>
      <button id='btnMsLogin' class='btn'>Entrar</button>
      <button id='btnMsLogout' class='btn hidden'>Sair</button>
    </div>
  </div>

  <div class='content stack gap'>
    <!-- PAINEL PROFESSOR -->
    <section id='secProfessor' class='section hidden'>
      <div class='sec-head'>
        <h2>As minhas aulas</h2>
        <div class='sec-actions'>
          <input id='profData' type='date' class='input'/>
          <button id='btnProfHoje' class='btn'>Hoje</button>
          <button id='btnProfExportPDF' class='btn'>Exportar meus registos (PDF)</button>
          <button id='btnProfExportXLSX' class='btn'>Exportar meus registos (XLSX)</button>
          <button id='btnProfExportFiltros' class='btn'>Exportar filtrado…</button>
        </div>
      </div>

      <div class='stack gap'>
        <div class='card'>
          <div class='sec-head'>
            <h3>Registos do dia</h3>
            <div class='muted' id='profInfo'></div>
          </div>
          <div style='overflow:auto'>
            <table class='table' id='tblHoje'>
              <thead>
                <tr>
                  <th>Hora</th><th>Disciplina</th><th>Aluno</th><th>Nº Lição</th><th>Sumário</th><th>Presença</th><th>Ação</th>
                </tr>
              </thead>
              <tbody></tbody>
            </table>
          </div>
          <div class='sec-actions' style='margin-top:8px'>
            <button id='btnSalvarSelecionados' class='btn'>Guardar selecionados</button>
          </div>
        </div>

        <div class='card'>
          <div class='sec-head'>
            <h3>Registos em falta</h3>
            <div class='muted'>Dias anteriores sem registo</div>
          </div>
          <div style='overflow:auto'>
            <table class='table' id='tblPend'>
              <thead>
                <tr>
                  <th>Data</th><th>Disciplina</th><th>Aluno</th><th>Ação</th>
                </tr>
              </thead>
              <tbody></tbody>
            </table>
          </div>
        </div>
      </div>
    </section>

    <!-- ADMINISTRAÇÃO -->
    <section id='admin' class='section hidden'>
      <div class='sec-head'>
        <h2>Administração</h2>
        <div class='sec-actions'>
          <label class='muted'>Entidade:</label>
          <select id='adminEntity' class='input'>
            <option value='professores'>Professores</option>
            <option value='alunos'>Alunos</option>
            <option value='disciplinas'>Disciplinas</option>
            <option value='oficinas'>Aulas</option>
          </select>
          <button id='btnAdminNovo' class='btn'>Novo</button>
          <button id='btnAdminEditar' class='btn' disabled>Editar</button>
          <button id='btnAdminApagar' class='btn' disabled>Apagar</button>
        </div>
      </div>

      <div class='card'>
        <strong>Importar/Exportar listas (XLSX)</strong>
        <div class='sec-actions' style='margin-top:8px'>
          <button class='btn' data-import-entity='professores'>Importar Professores</button>
          <button class='btn' data-import-entity='alunos'>Importar Alunos</button>
          <button class='btn' data-import-entity='disciplinas'>Importar Disciplinas</button>
          <button class='btn' data-import-entity='oficinas'>Importar Aulas</button>
          <input id='fileImportEntity' type='file' class='input-file' accept='.xlsx,.csv'/>
          <button id='btnAdminExportLista' class='btn'>Exportar lista (XLSX)</button>
        </div>
        <div id='adminImportInfo' class='muted' style='margin-top:6px'></div>
      </div>

      <div id='adminGrid' style='margin-top:10px'></div>
    </section>

    <!-- EXPORTAR & BACKUP -->
    <section id='secExportBackup' class='section hidden'>
      <div class='sec-head'>
        <h2>Exportar & Backup</h2>
        <div class='sec-actions'>
          <button id='btnExportRegXlsx' class='btn'>Exportar registos (XLSX)</button>
          <button id='btnExportRegPdf' class='btn'>Exportar registos (PDF)</button>
          <button id='btnExportFiltrado' class='btn'>Exportar filtrado…</button>
          <button id='btnBackupNow' class='btn'>Backup agora</button>
        </div>
      </div>
      <div class='card'>
        <strong>Diagnóstico</strong>
        <div id='diagInfo' class='muted' style='margin-top:6px'></div>
        <div id='adminGateInfo' class='muted' style='margin-top:6px'></div>
        <div class='sec-actions' style='margin-top:8px'>
          <button id='btnDiagCreateFolders' class='btn'>Criar pastas</button>
          <button id='btnDiagListFolder' class='btn'>Listar pasta</button>
        </div>
      </div>
    </section>
  </div>

  <!-- LIBS -->
  <script src='https://alcdn.msauth.net/browser/2.38.0/js/msal-browser.min.js'></script>
  <script src='https://cdn.jsdelivr.net/npm/sweetalert2@11/dist/sweetalert2.all.min.js'></script>
  <script src='https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js'></script>
  <script src='https://cdn.jsdelivr.net/npm/jspdf@2.5.1/dist/jspdf.umd.min.js'></script>
  <script src='https://cdn.jsdelivr.net/npm/jspdf-autotable@3.8.2/dist/jspdf.plugin.autotable.min.js'></script>

  <!-- APP -->
  <script src='app.js'></script>
</body>
</html>
